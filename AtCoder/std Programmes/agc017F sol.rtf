{\rtf1\ansi\deff3\adeflang1025
{\fonttbl{\f0\froman\fprq2\fcharset0 Times New Roman;}{\f1\froman\fprq2\fcharset2 Symbol;}{\f2\fswiss\fprq2\fcharset0 Arial;}{\f3\froman\fprq2\fcharset0 Liberation Serif{\*\falt Times New Roman};}{\f4\froman\fprq2\fcharset0 Liberation Sans{\*\falt Arial};}{\f5\froman\fprq2\fcharset128 \'91\'76\'91\'cc;}{\f6\fnil\fprq2\fcharset0 Noto Sans CJK SC Regular;}{\f7\fnil\fprq2\fcharset128 \'91\'76\'91\'cc;}{\f8\fnil\fprq2\fcharset0 Liberation Serif{\*\falt Times New Roman};}}
{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;\red192\green192\blue192;}
{\stylesheet{\s0\snext0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033 Normal;}
{\s15\sbasedon0\snext16\ql\nowidctlpar\hyphpar0\sb240\sa120\keepn\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f4\fs28 \u26631\'3f\u39064\'3f\u26679\'3f\u24335\'3f;}
{\s16\sbasedon0\snext16\sl288\slmult1\ql\nowidctlpar\hyphpar0\sb0\sa140\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24 \u27491\'3f\u25991\'3f;}
{\s17\sbasedon16\snext17\sl288\slmult1\ql\nowidctlpar\hyphpar0\sb0\sa140\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24 \u21015\'3f\u34920\'3f;}
{\s18\sbasedon0\snext18\ql\nowidctlpar\hyphpar0\sb120\sa120\ltrpar\cf1\i\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24 \u39064\'3f\u27880\'3f;}
{\s19\sbasedon0\snext19\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24 \u32034\'3f\u24341\'3f;}
}{\*\generator LibreOffice/5.3.1.2$Linux_X86_64 LibreOffice_project/30m0$Build-2}{\info{\creatim\yr0\mo0\dy0\hr0\min0}{\revtim\yr2018\mo2\dy20\hr14\min31}{\printim\yr0\mo0\dy0\hr0\min0}}{\*\userprops}\deftab720
\hyphauto0\viewscale140
{\*\pgdsctbl
{\pgdsc0\pgdscuse451\pgwsxn12240\pghsxn15840\marglsxn1800\margrsxn1800\margtsxn1440\margbsxn1440\pgdscnxt0 \u40664\'3f\u35748\'3f\u26679\'3f\u24335\'3f;}}
\formshade{\*\pgdscno0}\paperh15840\paperw12240\margl1800\margr1800\margt1440\margb1440\sectd\sbknone\sectunlocked1\pgndec\pgwsxn12240\pghsxn15840\marglsxn1800\margrsxn1800\margtsxn1440\margbsxn1440\ftnbj\ftnstart1\ftnrstcont\ftnnar\aenddoc\aftnrstcont\aftnstart1\aftnnrlc
{\*\ftnsep}\pgndec\pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
Petr}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5

\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5

\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
import java.io.OutputStream;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
import java.io.IOException;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
import java.io.InputStream;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
import java.io.PrintWriter;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
import java.util.StringTokenizer;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
import java.io.IOException;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
import java.io.BufferedReader;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
import java.io.InputStreamReader;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
import java.io.InputStream;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
/**}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
* Built using CHelper plug-in}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
* Actual solution is at the top}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
*/}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
public class Main \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
public static void main(String[] args) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
InputStream inputStream = System.in;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
OutputStream outputStream = System.out;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
InputReader in = new InputReader(inputStream);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
PrintWriter out = new PrintWriter(outputStream);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
TaskF solver = new TaskF();}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
solver.solve(1, in, out);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
out.close();}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
static class TaskF \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
static final int MODULO = (int) (1e9 + 7);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
public void solve(int testNumber, InputReader in, PrintWriter out) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int n = in.nextInt();}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int m = in.nextInt();}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int k = in.nextInt();}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int[] mustMask = new int[m];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int[] mustValue = new int[m];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int i = 0; i < k; ++i) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int a = in.nextInt() - 1;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int b = in.nextInt() - 1;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int c = in.nextInt();}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
mustMask[a] |= 1 << b;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
mustValue[a] |= c << b;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int[] ways = new int[1 << (n - 1)];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int[] nways = new int[1 << (n - 1)];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
ways[0] = 1;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int i = 0; i < m; ++i) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int pos = 0; pos < n - 1; ++pos) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
System.arraycopy(ways, 0, nways, 0, ways.length);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int bit = 1 << pos;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int old = 0; old < ways.length; ++old)}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
if (ways[old] != 0) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
if ((old & bit) == 0) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int nxt = (old & (old - bit)) + bit;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
nways[nxt] += ways[old];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
if (nways[nxt] >= MODULO) nways[nxt] -= MODULO;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int[] tmp = ways;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
ways = nways;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
nways = tmp;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int mask = mustMask[i];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int val = mustValue[i];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int old = 0; old < ways.length; ++old) if ((old & mask) != val) ways[old] = 0;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
long res = 0;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int x : ways) res += x;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
res %= MODULO;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
out.println(res);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
static class InputReader \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
public BufferedReader reader;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
public StringTokenizer tokenizer;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
public InputReader(InputStream stream) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
reader = new BufferedReader(new InputStreamReader(stream), 32768);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
tokenizer = null;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
public String next() \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
while (tokenizer == null || !tokenizer.hasMoreTokens()) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
try \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
tokenizer = new StringTokenizer(reader.readLine());}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\} catch (IOException e) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
throw new RuntimeException(e);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
return tokenizer.nextToken();}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
public int nextInt() \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
return Integer.parseInt(next());}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5

\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5

\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
niyaz}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5

\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#include <cstdio>}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int f[42][42];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int dp[1 << 20];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int const MOD = 1000000007;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
void add(int &a, int b) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
  }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
a += b;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
  }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
if (a >= MOD) a -= MOD;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int main() \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
  }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int n, m, k;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
  }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
scanf("%d%d%d", &n, &m, &k);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
  }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int i = 0; i < m; i++) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int j = 0; j < n; j++) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
      }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
f[i][j] = -1;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
  }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
  }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int i = 0; i < k; i++) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int who, where, what;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
scanf("%d%d%d", &who, &where, &what);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
--who;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
--where;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
f[who][where] = what;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
  }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
  }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int i = 0; i < 1 << (n - 1); i++) dp[i] = 0;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
  }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
dp[0] = 1;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
  }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int q = 0; q < m; q++) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int pos = 0; pos < n - 1; pos++) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
      }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int mask = 0; mask < 1 << (n - 1); mask++) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
if (((mask >> pos) & 1) == 1) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
          }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
continue;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int nmask = mask ^ (1 << pos);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int npos = pos + 1;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
while (npos < n - 1 && ((nmask >> npos) & 1) == 0) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
          }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
++npos;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
if (npos < n - 1) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
          }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
nmask &= ~(1 << npos);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
add(dp[nmask], dp[mask]);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
      }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int ones = 0;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int zeros = 0;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int i = 0; i < n - 1; i++) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
      }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
if (f[q][i] == 0) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
zeros |= 1 << i;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
      }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\} else if (f[q][i] == 1) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
ones |= 1 << i;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
      }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int mask = 0; mask < 1 << (n - 1); mask++) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
      }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
if ((mask & ones) != ones || (~mask & zeros) != zeros) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
dp[mask] = 0;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
      }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
// printf("q = %d\\n", q);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
// for (int mask = 0; mask < 1 << (n - 1); mask++) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
//   printf(" mask = %d, val = %d\\n", mask, dp[mask]);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
// \}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
  }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
  }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int ans = 0;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
  }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int i = 0; i < 1 << (n - 1); i++) add(ans, dp[i]);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
  }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
printf("%d\\n", ans);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
//exactly the same as yutaka}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5

\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
yutaka}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5

\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
//core method}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
// build a kind of route to limit the transformation of dynamic programming}
\par \pard\plain \s16\sl288\slmult1\ql\nowidctlpar\hyphpar0\sb0\sa140\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\sl288\slmult1{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
// optimize the complexity from O(N^3) to O(N^2*N)}
\par \pard\plain \s16\sl288\slmult1\ql\nowidctlpar\hyphpar0\sb0\sa140\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\sl288\slmult1\sb0\sa0\rtlch \ltrch\loch

\par \pard\plain \s16\sl288\slmult1\ql\nowidctlpar\hyphpar0\sb0\sa140\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\sl288\slmult1{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
//a better solution: do it like izban: init the nxt to optimize the transformation}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#include <cstdio>}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#include <cstdlib>}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#include <algorithm>}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#include <vector>}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#include <cstring>}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#include <queue>}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#include <set>}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#include <map>}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#include <functional>}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#include <cmath>}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#include <string>}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#define SIZE 25}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#define BT (1<<21)}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#define MOD 1000000007}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
using namespace std;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
typedef long long int ll;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
typedef pair <int,int> P;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
ll dp[BT];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
ll nxt[BT];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
//dp and nxt: using rolling technique}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int id[SIZE][SIZE];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int n,m,K;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
void solve()}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab for(int S=0;S<1<<n;S++) nxt[S]=dp[S];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab for(int i=0;i<n;i++)}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab for(int S=0;S<1<<n;S++)}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab if(!(S>>i&1))}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab \tab int to=i+1;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab \tab while(to<n&&!(S>>to&1)) to++;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab \tab if(to<n)}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab \tab \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab \tab \tab nxt[S+(1<<i)-(1<<to)]+=nxt[S];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab \tab \}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab \tab else}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab \tab \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab \tab \tab nxt[S+(1<<i)]+=nxt[S];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab \tab \}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab \}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab for(int S=0;S<1<<n;S++) nxt[S]%=MOD;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int main()}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab scanf("%d %d %d",&n,&m,&K);n--;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab memset(id,-1,sizeof(id));}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab for(int i=0;i<K;i++)}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab int a,b,c;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab scanf("%d %d %d",&a,&b,&c);a--,b--;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab id[a][b]=c;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab memset(dp,0,sizeof(dp));}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab dp[0]=1;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab for(int i=0;i<m;i++)}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab solve();}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab //judging whether the method is legal}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab for(int S=0;S<1<<n;S++)}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab bool up=true;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab for(int j=0;j<n;j++)}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab \tab if(id[i][j]==0&&(S>>j&1)) up=false;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab \tab else if(id[i][j]==1&&!(S>>j&1)) up=false;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab \}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab if(!up) dp[S]=0;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab else dp[S]=nxt[S];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab ll ret=0;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab for(int S=0;S<1<<n;S++)}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab ret+=dp[S];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab if(ret>=MOD) ret-=MOD;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab printf("%lld\\n",ret);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab return 0;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5

\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
izban}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5

\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#include <bits/stdc++.h>}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
using namespace std;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
typedef long long ll;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
const int MOD = (int)1e9 + 7;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
void add(int &x, int y) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
x = (x + y) % MOD;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int main() \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#ifdef HOME}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
freopen("in", "r", stdin);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#endif}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int n, m, k;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
while (cin >> n >> m >> k) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
vector<int> a(k), b(k), c(k);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int i = 0; i < k; i++) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
cin >> a[i] >> b[i] >> c[i];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
a[i]--; b[i]--;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
n--;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
vector<vector<int> > need(m, vector<int>(n, -1));}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int i = 0; i < k; i++) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
need[a[i]][b[i]] = c[i];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
vector<vector<int> > nxt(1 << n, vector<int>(n, -1));}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int mask = 0; mask < (1 << n); mask++) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int i = 0; i < n; i++) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
if (!((mask >> i) & 1)) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int nmask = mask ^ (1 << i);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int j = i + 1;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
while (j < n) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
if ((nmask >> j) & 1) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
nmask ^= 1 << j;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
break;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
j++;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
nxt[mask][i] = nmask;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
vector<vector<int> > dp(n + 1, vector<int>(1 << n, 0));}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
dp[0][0] = 1;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int i = 0; i < m; i++) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int j = 0; j < n; j++) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
dp[j + 1].assign(1 << n, 0);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int mask = 0; mask < (1 << n); mask++) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
add(dp[j + 1][mask], dp[j][mask]);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
if (!((mask >> j) & 1)) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
add(dp[j + 1][nxt[mask][j]], dp[j][mask]);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
dp[0] = dp[n];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int mask = 0; mask < (1 << n); mask++) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int j = 0; j < n; j++) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
if (need[i][j] != -1 && ((mask >> j) & 1) != need[i][j]) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
dp[0][mask] = 0;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
                }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
            }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int ans = 0;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
for (int mask = 0; mask < (1 << n); mask++) add(ans, dp[0][mask]);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
        }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
printf("%d\\n", ans);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#ifdef HOME}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
cerr << clock() / (double)CLOCKS_PER_SEC << endl;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#endif}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
    }{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
return 0;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5

\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
krijgertje}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5

\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
using namespace std;  }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#define PB push_back  }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#define MP make_pair  }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#define SZ(v) ((int)(v).size())  }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#define FOR(i,a,b) for(int i=(a);i<(b);++i)  }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#define REP(i,n) FOR(i,0,n)  }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#define FORE(i,a,b) for(int i=(a);i<=(b);++i)  }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#define REPE(i,n) FORE(i,0,n)  }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#define FORSZ(i,a,v) FOR(i,a,SZ(v))  }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#define REPSZ(i,v) REP(i,SZ(v))  }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
typedef long long ll;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
typedef unsigned long long ull;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
ll gcd(ll a,ll b) \{ return b==0?a:gcd(b,a%b); \}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
const int MAXN=19;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
const int MAXPATH=20;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
const int MOD=1000000007;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int n,npath,nfixes;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int fix[MAXPATH][MAXN];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int dp[1<<MAXN];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int calcnmask(int mask,int j) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab int suf=mask&((1<<j)-1),prf=mask^suf;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab if(prf==0) return suf^(1<<j);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab int lsb=prf&-prf;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab return mask^lsb^(1<<j);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
void run() \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab scanf("%d%d%d",&n,&npath,&nfixes); --n;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab REP(i,npath) REP(j,n) fix[i][j]=-1;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab REP(i,nfixes) \{ int a,b,c; scanf("%d%d%d",&a,&b,&c); --a,--b; fix[a][b]=c; \}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab memset(dp,0,sizeof(dp)); dp[0]=1;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab REP(i,npath) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab REP(j,n) for(int mask=(1<<n)-1;mask>=0;--mask) \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab if(dp[mask]==0||((mask>>j)&1)==1) continue;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab int nmask=calcnmask(mask,j);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab if((dp[nmask]+=dp[mask])>=MOD) dp[nmask]-=MOD;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab REP(j,n) if(fix[i][j]!=-1) REP(mask,1<<n) if(((mask>>j)&1)!=fix[i][j]) dp[mask]=0;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab //printf("%d:",i); REP(mask,1<<n) if(dp[mask]!=0) printf(" %x=%d",mask,dp[mask]); puts("");}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab int ret=0; REP(mask,1<<n) if((ret+=dp[mask])>=MOD) ret-=MOD; printf("%d\\n",ret);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int main() \{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab run();}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab return 0;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5

\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
zigui}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5

\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
using namespace std;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
typedef pair<int, int> Pi;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
typedef long long ll;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#define pii Pi}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#define pll PL}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#define Fi first}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#define Se second}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#define pb(x) push_back(x)}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
//#define sz(x) ((int)(x).size())}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#define rep(i, n) for(int i=0;i<n;i++)}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
#define all(x) (x).begin(), (x).end()}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
typedef tuple<int, int, int> t3;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
typedef pair<ll, ll> pll;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
typedef long double ldouble;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
typedef pair<double, double> pdd;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
const double PI = acos(-1);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
const double EPS = 1e-9;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
const int MX = 1<<20;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
const int MM = 1000000007;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int T[MX];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int msk[MX], val[MX];}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int N, M, K;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int nxt(int i, int v)\{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab return ((i + (1<<v)) | (i^1<<v)) & ((1<<N)-1);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
int main()}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab scanf("%d%d%d", &N, &M, &K); N--;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab for(int i = 1; i <= K; i++)\{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab int a, b, c;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab scanf("%d%d%d", &a, &b, &c);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab msk[a] |= 1<<b-1;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab val[a] |= c<<b-1;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\afs22\alang2052\rtlch \ltrch\loch\f5
 }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab for(int i = 0; i < 1<<N; i++)\{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab if( val[1] == (msk[1]&i)) T[i] = 1;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab for(int t = 2; t <= M; t++)\{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab for(int v = N-1; v >= 0; v--)\{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab for(int i = 0; i < 1<<N; i++)\{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab \tab if( i&1<<v ) T[i] = (T[i] + T[nxt(i, v)]) % MM;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab \}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab }
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab for(int i = 0; i < 1<<N; i++)\{}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \tab if( val[t] != (msk[t]&i) ) T[i] = 0;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \tab \}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab \}}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab int ans = 0;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab for(int i = 0; i < 1<<N; i++) ans = (ans + T[i]) % MM;}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\tab printf("%d\\n", ans);}
\par \pard\plain \s0\ql\nowidctlpar\hyphpar0\ltrpar\cf1\kerning1\dbch\af6\langfe1081\dbch\af8\afs24\alang1033\loch\f3\fs24\lang1033\sl276\slmult1\sb0\sa200{\dbch\af7\rtlch \ltrch\loch\fs22\lang2052\loch\f5\hich\af5
\}}
\par }